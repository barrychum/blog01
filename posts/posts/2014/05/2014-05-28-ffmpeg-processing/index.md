---
title: "ffmpeg processing"
date: 2014-05-28
categories: 
  - "tips-and-tricks"
---

Extract a short video for testing `ffmpeg -i input.mp4 -vcodec copy -acodec copy -ss 6:45 -t 0:10 output.mp4` Overlay a PNG onto a video `ffmpeg -i input.mp4 -vf "movie=overlay.png [over]; [in] [over] overlay=main_w-overlay_w-10:main_h-overlay_h-10" output.mp4` Crop left & right image to separate files `ffmpeg -i input.mp4 -filter:v "crop=960:800:0:0" -acodec copy -crf 20 left.mp4 ffmpeg -i input.mp4 -filter:v "crop=960:800:960:0" -an -crf 20 right.mp4` Combine left and right image into a SBS image `ffmpeg -i left.mp4 -vf "movie=right.mp4 [in1]; [in]pad=iw*2:ih:iw:0[in0];[in0][in1] overlay=0:0 [out]" sbs.mp4` One-liner to swap left and right video `ffmpeg -i input.mp4 -vf "crop=960:800:0:0,pad=iw*2:ih:iw:0[in0];movie=input.mp4,crop=960:800:960:0[in1]; [in0][in1] overlay=0:0[out]" -crf 22 -acodec copy output.mp4` Remove a stream (assume you have 0:0, 0:1, 0:2, 0:3, 0:4, etc) `ffmpeg -i food.ts -map 0:0 -map 0:1 -map 0:3 -c copy output2.ts` Overlay subtitle stream to main video stream, deinterlace `ffmpeg -i output2.ts -filter_complex "[0:0][0:2]overlay[v];[v]yadif=0:-1:0[x];[x]scale=720:-1[y]" -map [y] -map 0:1 -vb 4M output4.mpg` Overlay subtitle stream, resize and reposition `ffmpeg -i test2.ts -filter_complex "[0:3]scale=1920:750[sub];[0:0]scale=720:408[main];[main][sub]overlay=0:0[v];[v]yadif=0:-1:0[x]" -map [x] -map 0:1 -vb 4M output3.mpg` `ffmpeg -i test2.ts -filter_complex "[0:3]scale=1440:-1[sub];[0:0]scale=720:408[main];[main][sub]overlay=100:-20[v]" -map [v] -map 0:1 -vb 4M output3.mpg` ``(ffprobe.exe -show_format -show_streams -print_format json ) -join "`n" | ConvertFrom-Json`` Convert to H265 `ffmpeg -i input -c:v libx265 -preset medium -x265-params crf=28 -c:a aac -strict experimental -b:a 128k output.mp4` Convert Drone footages (H265, no audio, 720p,
